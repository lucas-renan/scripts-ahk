;#SiMco 2019 - renan.m
;Script com finalidade de criar repasses no Tasy Delphi
;Versão: 0.1

;------configurações
#NoEnv  ; Recomendado para performance e compatibilidade com versões do autohotkey futuras
SetWorkingDir %A_ScriptDir%  ; Garante um diretório inicial consistente.(???)
SetKeyDelay, 80
;----------

p:: ;------pausa o script, para emergências
    pause
return

; ínicio do bloco de Repasses
s:: 
SetBatchLines, 80 ; milisegundos entre cada execução
;----------

;-----variáveis
num_linha := 1
;CodProcd := ["0", "289910021", "289910361", "289910107", "289910352", "28062124", "289910174", "27040364", "289910225", "289910366", "289910373", "28010060", "28062777", "28062345", "289910269", "289910047", "28050240", "28999948", "28050436", "289910041", "289910017", "289910018", "289910019", "29999939", "289910200", "289910199", "289910389", "21010288", "28130294", "28060210", "28130480", "28999901", "289910049", "28999903", "289910053", "289910282", "28160088", "289910288", "28011104", "28050770", "28061497", "29999962", "28062851", "28062850", "289910331", "29999960", "28999914", "28999917", "28061632", "28060083", "28090160", "28062078", "28062839", "28061640", "28061624", "28060164", "28100514", "289910124", "28040988", "28061594", "28999949", "289910313", "28060105", "289910114", "28050169", "28062843", "28150180", "28010604", "289910249", "289910115", "289910291", "28062787", "28060075", "28100271", "289910162", "28130219", "28060229", "28050142", "289910310", "289910033", "289910278", "289910193", "289910237", "289910234", "289910364", "289910188", "289910070", "28011708", "28061276", "28062913", "28061195", "31120075", "289910223", "28010736", "289910274", "28010698", "28060156", "28010760", "28010230", "28060113", "28062860", "28061608", "28062861", "28130553", "28062920", "28010035", "28010221", "289910355", "289910397", "28061748", "28062515", "28990704", "28050754", "28050061", "28050126", "28050819", "28011449", "289910265", "28050258", "289910184", "289910142", "31120202", "28010370", "289910318", "28130472", "28062858", "28030252", "289910104", "289910345", "28060237", "28062747", "289910385", "289910106", "28062942", "289910136", "289910260", "289910190", "28040376", "289910259", "289910261", "289910217", "28032803", "28062705", "28062719", "28062738", "28062712", "28062801", "28062905", "28062704", "28062718", "28062726", "28062835", "28062707", "28062709", "28062713", "28062715", "28062729", "28062882", "28062739", "28062743", "28062800", "28062894", "28062898", "28062815", "289910262", "289910263", "28062901", "28062871", "28062725", "28062706", "28062732", "28060601", "28062864", "28062400", "28062865", "28062866", "28062867", "28062868", "28062708", "28062869", "28062870", "28062711", "28062872", "28062873", "28062714", "28062874", "28062875", "28062716", "28062717", "28062877", "28062876", "28062720", "28062721", "28062722", "28062723", "28062724", "28062727", "28062878", "28062799", "28062879", "28062880", "28062730", "28062881", "28062733", "28062734", "28062735", "28062737", "28062740", "28062883", "28062884", "28062885", "28062802", "28062886", "28062887", "28062804", "28062888", "28062806", "28062889", "28062890", "28062891", "28062892", "28062807", "28062893", "28062810", "28062811", "28062812", "28062895", "28062896", "28062897", "28062816", "28062817", "28062899", "28062902", "28062903", "28062820", "28062904", "28062906", "28062907", "28150309", "28062454", "28062755", "28999944", "28061802", "28062789", "28060407", "28062759", "289910238", "28062927", "289910121", "289910118", "289910119", "289910120", "28062943", "28050843", "289910006", "289910376", "31120113", "28100239", "28010752", "289910164", "289910002", "28062183", "28040333", "28062922", "29999984", "28999953", "28150260", "289910350", "28062788", "31120016", "28050223", "28130464", "28050215", "28061918", "28061853", "28062768", "28062767", "28050924", "289910093", "289910145", "289910143", "289910144", "289910189", "26100118", "28010183", "28061225", "28061721", "28062752", "289910069", "289910230", "289910315", "289910316", "289910317", "289910266", "28062911", "289910301", "289910302", "28062035", "28060296", "289910095", "2999934", "28062935", "28062936", "28062908", "28062909", "289910146", "289910224", "29999976", "289910076", "289910077", "289910078", "28061829", "19019999", "289910222", "29999935", "289910297", "289910105", "289910287", "31120245", "289910281", "289910391", "28050430", "289910390", "289910388", "289910312", "28062940", "28050037", "28062702", "289910264", "289910159", "28062862", "28050304", "289910111", "289910112", "289910113", "289910117", "289910358", "28999928", "28061152", "31120496", "28090217", "289910339", "28050983", "289910116", "289910038", "28160461", "28061667", "289910256", "28160462", "28060130", "28061144", "28061179", "28061136", "289910343", "289910354", "28999909", "28050800", "28062698", "28999932", "29999931", "28060920", "28010728", "289910079", "28062915", "289910384", "289910226", "289910227", "289910048", "289910092", "28061870", "28130548", "289910300", "28140168", "28061861", "289910051", "28062945", "28062620", "28062774", "28061780", "28062762", "28062761", "28062763", "28999935", "289910365", "289910229", "289910294", "28130556", "289910346", "289910152", "289910153", "289910154", "289910257", "289910011", "28011783", "289910335", "28050509", "289910173", "289910348", "289910279", "289910321", "28061390", "28062938", "28032807", "289910059", "289910341", "28150350", "28050916", "28051077", "28061403", "28050797", "28011791", "28041003", "289910395", "289910396", "289910387", "28140109", "28032805", "289910037", "289910284", "28990698", "28010132", "289910306", "28160470", "28160471", "28040090", "289910246", "289910182", "29999992", "28032806", "28062671", "28062748", "28062749", "29999958", "28051025", "28062929", "289910192", "289910323", "289910066", "31120334", "28050975", "289910035", "28050967", "289910196", "289910061", "28130405", "28062027", "289910004", "289910008", "289910122", "289910034", "289910068", "289910309", "289910328", "289910027", "289910247", "289910096", "289910330", "28062923", "28062776", "28062924", "28061128", "28061675", "289910232", "289910233", "289910336", "289910015", "289910219", "289910062", "289910255", "289910359", "289910194", "289910128", "28062019", "289910360", "28061934", "289910167", "289910023", "28032804", "289910160", "289910349", "28999911", "289910304", "289910050", "289910084", "289910080", "289910085", "289910081", "289910220", "289910307", "29999973", "28130536", "28100719", "289910231", "289910215", "289910280", "289910072", "289910073", "289910089", "289910090", "289910088", "289910087", "289910082", "289910083", "289910374", "28050991", "28990707", "289910290", "28062753", "289910100", "289910169", "28051017", "289910202", "289910103", "289910161", "28999703", "289910243", "289910043", "289910044", "289910332", "289910235", "31120495", "28050088", "28062796", "289910172", "289910289", "289910272", "289910333", "28062916", "28062917", "28062919", "289910357", "28050894", "289910071", "28062540", "289910042", "289910283", "28051081", "28062842", "28130555", "289910342", "289910127", "289910251", "289910252", "289910025", "289910009", "28062918", "28010361", "289910036", "289910379", "289910380", "28062925", "289910337", "289910135", "289910010", "289910175", "28062930", "28062849", "289910377", "289910110", "289910286", "28051016", "28051078", "28051079", "289910363", "289910250", "289910029", "31120497", "289910244", "289910131", "289910003", "289910277", "289910329", "28062772", "289910353", "289910130", "28050045", "289910206", "289910098", "289910216", "289910005", "289910016", "289910032", "289910129", "289910097", "289910045", "28160134", "289910378", "28160275", "289910393", "289910308", "28062928", "289910347", "289910305", "289910214", "289910126", "289910392", "289910369", "28140176", "289910368", "28130111", "289910203", "289910207", "289910198", "289910320", "29999943", "289910148", "28062926", "289910024", "28051009", "28062793", "289910156", "289910157", "289910292", "289910394", "28062921", "289910101", "289910102", "28062775", "28062941", "289910158", "289910138", "28130448", "289910241", "289910314", "289910201", "289910094", "28062944", "289910344", "28062846", "289910205", "289910179", "289910298", "28062856", "289910054", "289910375", "289910248", "289910268", "289910040", "289910245", "289910340", "289910303", "289910267", "289910166", "289910221", "289910187", "289910181", "28051080", "289910276", "289910026", "289910022", "289910327", "26100045", "289910149", "289910147", "28062914", "289910296", "27041107", "289910311", "289910074", "28062795", "289910319", "28999704", "28990699", "289910125", "289910334", "289910058", "289910039", "289910204", "28061926", "289910001", "26020025", "289910086", "28062840", "289910064", "28062845", "289910212", "289910176", "289910140", "289910099", "29999975", "289910183", "289910356", "289910060", "289910236", "289910139", "289910185", "289910218", "289910150", "27040984", "289910065", "28170164", "289910123", "28160274", "289910210", "28050835", "289910046", "289910242", "289910052", "31120385", "289910056", "289910293", "289910338", "289910382", "28062213", "289910155", "289910091", "289910171", "289910031", "289910067", "289910109", "289910383", "289910057", "289910030"]
;Cred := ["0", "8,12", "8,12", "8,13", "8,13", "8,15", "8,25", "8,25", "8,25", "8,25", "8,38", "8,5", "8,5", "8,5", "8,59", "8,62", "8,66", "8,78", "8,89", "8,91", "8,95", "8,95", "8,95", "9", "9,09", "9,09", "9,1", "40", "9,12", "9,14", "9,19", "9,35", "9,35", "9,35", "9,35", "9,35", "9,38", "9,42", "9,45", "9,5", "9,5", "9,5", "9,5", "9,5", "9,5", "9,5", "9,58", "9,61", "9,86", "9,89", "9,99", "9,99", "10", "10,15", "10,19", "10,25", "10,38", "10,41", "10,44", "10,5", "10,53", "10,55", "10,9", "10,94", "11", "11,02", "11,32", "11,35", "11,38", "11,4", "11,4", "11,5", "11,5", "11,5", "11,55", "11,57", "11,85", "12", "12,01", "12,11", "12,16", "12,16", "12,16", "12,16", "12,16", "12,21", "12,24", "12,33", "12,36", "12,36", "12,5", "12,66", "12,66", "12,9", "12,92", "12,94", "12,99", "13,12", "13,15", "13,25", "13,44", "13,5", "13,5", "13,5", "13,5", "13,5", "13,6", "13,73", "13,74", "13,9", "13,92", "13,95", "14", "14,08", "14,15", "14,19", "14,21", "14,33", "14,4", "14,56", "14,56", "14,71", "14,73", "14,8", "15", "15", "15", "15,05", "15,12", "15,15", "15,15", "15,22", "15,37", "15,76", "15,76", "15,76", "15,76", "15,76", "15,76", "15,76", "15,76", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16,1", "16,12", "16,12", "16,25", "16,4", "16,41", "16,5", "16,5", "16,51", "16,51", "16,78", "16,78", "16,78", "16,78", "16,78", "17", "17,01", "17,05", "17,19", "17,5", "17,5", "17,75", "17,85", "17,87", "18", "18,35", "18,4", "18,4", "18,49", "18,51", "18,59", "18,6", "18,62", "18,71", "18,72", "18,75", "19", "19", "19", "19", "19,41", "19,84", "19,84", "19,84", "19,93", "20", "20", "20", "20", "20", "20,03", "20,17", "20,19", "20,19", "20,19", "20,19", "20,19", "20,37", "20,37", "20,44", "20,44", "20,64", "20,64", "20,82", "20,82", "20,82", "20,82", "20,9", "20,96", "21", "21", "21", "21", "21,02", "21,07", "21,26", "21,59", "21,75", "21,84", "22,04", "22,34", "22,37", "22,39", "22,4", "22,65", "22,8", "22,8", "22,8", "23,1", "23,21", "23,21", "23,26", "23,34", "23,57", "23,73", "23,73", "23,73", "23,86", "23,91", "24", "24,16", "24,16", "24,26", "24,46", "24,5", "24,58", "24,78", "25", "25", "25", "25", "25", "25,41", "25,5", "25,75", "25,84", "25,9", "25,91", "26,4", "27", "27", "27", "27", "27,2", "27,36", "27,42", "27,5", "27,69", "27,69", "28,1", "28,42", "28,5", "28,71", "28,91", "29,11", "29,5", "29,75", "29,9", "30", "30,11", "30,75", "31", "31", "31,25", "31,5", "31,71", "32,12", "32,27", "32,28", "32,32", "32,35", "32,35", "32,35", "32,35", "32,53", "32,9", "33,37", "33,37", "33,64", "33,79", "33,88", "33,88", "35,5", "35,68", "35,82", "36,01", "36,15", "36,3", "36,5", "36,77", "37,38", "37,45", "37,6", "37,8", "38", "38", "38,18", "38,22", "38,42", "39,5", "40,43", "41", "41,15", "41,15", "41,72", "41,72", "41,86", "41,86", "42,04", "42,5", "42,64", "43", "43", "43", "43,37", "43,67", "44,17", "44,44", "44,55", "45,6", "45,72", "45,81", "45,9", "46,2", "47,23", "47,33", "47,58", "47,76", "48,15", "48,52", "48,61", "49,34", "49,4", "49,6", "49,96", "50", "50,22", "50,39", "50,4", "50,65", "50,65", "50,65", "50,81", "51", "51,5", "51,5", "51,76", "52,01", "52,15", "52,8", "55,22", "56,04", "56,62", "57,64", "57,74", "57,81", "58", "58,73", "59,5", "59,57", "59,95", "60,65", "60,85", "61,06", "61,71", "62,91", "62,91", "62,91", "62,91", "62,91", "64,46", "65,09", "65,26", "66,71", "67,4", "67,47", "67,53", "67,73", "67,73", "67,93", "67,93", "67,93", "67,93", "67,93", "67,93", "68,49", "69", "69,87", "69,87", "70", "70,48", "70,88", "70,95", "71,33", "71,42", "71,44", "71,59", "72,14", "72,18", "72,18", "72,85", "73,1", "74,03", "75", "75", "75", "75,21", "76,18", "76,64", "76,65", "76,65", "76,99", "77,09", "79", "79,09", "80,5", "82,03", "83,6", "84,22", "84,64", "84,74", "84,92", "85", "85", "85", "85", "85", "85,3", "85,84", "87,55", "88,75", "88,75", "88,95", "93,51", "93,97", "94,5", "94,64", "95,44", "96,63", "96,64", "97,05", "97,05", "98", "98,08", "98,08", "98,27", "98,66", "98,84", "103,59", "103,63", "103,72", "104,16", "104,45", "105,3", "105,35", "108,85", "109,7", "109,82", "110,09", "110,38", "112,81", "112,95", "113,22", "116,26", "120", "123,12", "123,15", "124", "124,55", "126", "129,4", "133,5", "134,25", "135,28", "135,74", "136,4", "138,24", "138,46", "139,1", "139,64", "140,69", "140,72", "140,74", "140,74", "140,74", "142,65", "144,32", "144,54", "149,34", "150", "150", "150,46", "151,62", "151,62", "152,02", "152,3", "153,82", "158,49", "158,49", "158,82", "160", "163,66", "165,62", "168,42", "172,08", "174,8", "176,62", "181,15", "182", "189,03", "189,91", "197,31", "201,99", "202,04", "202,16", "207,02", "207,84", "220", "222,08", "225,08", "226,15", "227,83", "231,12", "233,9", "236,01", "241,03", "243,14", "246,88", "247", "249,07", "250,8", "250,8", "251", "255,2", "255,31", "255,31", "255,85", "258,4", "260,74", "270,58", "284,19", "285,08", "288,82", "290", "295", "295,32", "301", "306,95", "320", "320,28", "335,25", "336", "342", "346,71", "349,6", "366,35", "380,02", "380,88", "401,66", "410,81", "416", "417,38", "421,06", "434,9", "448,35", "452,88", "452,91", "454,51", "455,64", "465,59", "471,99", "542,62", "545,07", "548,29", "615", "618,43", "619,25", "680,96", "697", "700,58", "705,42", "726,38", "746,32", "769,61", "780,19", "887,05", "930", "930,86", "980,54", "1088,05", "1226,05", "1367,98", "1596,02", "2137,39", "3780,33"]
CodMedico := 736139


;-------------
;Loop % CodProcd.Length(){
Loop 3 {
    ;----ler o arquivo de txt com os codigos 
textfile1 := "codigos.txt"

Loop, Read, %textfile1%
{
	;A_LoopReadLine
	If (A_Index = num_linha) {
		line_contents1 := A_LoopReadLine
		Break
	}
}
;----------

;---- ler o arquivo de txt com os valores
textfile2 := "valores.txt"

Loop, Read, %textfile2%
{
	;A_LoopReadLine
	If (A_Index = num_linha) {
		line_contents2 := A_LoopReadLine
		Break
	}
}
;----------

    num_linha += 1
    Inicio:
        ;Send {Space}
        Send, !{n}
        Loop 18 {
            Send {Esc}
            Send {Tab}
            ;Send {Esc}
            ;Send {Esc}
        }
        Send %CodMedico%
        Sleep, 2
        Loop 7 {
            Send {Tab}
        }
        Send {Enter}
        Send {Tab}
        Send {Down}
        ;-----codigo procedimento
            Send %line_contents1%
        ;-----------
        Send {Enter}
        Send {Enter}
        Loop, 8 {
            Send {Tab}
        }
        Send {Down}
        Loop, 10 {
            Send {BackSpace}
        }
        ;-----------cred
            ;Send % Cred[num_linha]
            Send %line_contents2%
            ;Send % v2
        ;----------------
        
        Send {Tab}
        Send, !{s}
        Send, !{g}
        ;--------//// ACABA AQUI O cartao SiM
    }
ExitApp